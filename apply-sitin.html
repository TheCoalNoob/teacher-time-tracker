<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Apply for Sit-in</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <h2>Apply for Sit-in</h2>

  <form id="sitinForm">
    <label>Name:</label>
    <input type="text" id="name" required><br>

    <label>Year & Section:</label>
    <input type="text" id="year" required><br>

    <label>Room/Lab:</label>
    <input type="text" id="room" placeholder="Cisco Lab" required><br>

    <label>Start Time:</label>
    <input type="time" id="startTime" required><br>

    <label>End Time:</label>
    <input type="time" id="endTime" required><br>

    <label>Purpose:</label>
    <input type="text" id="purpose" required><br>

    <button type="submit">Submit</button>
  </form>

  <button onclick="location.href='index.html'">Back to Home</button>

  <script>
    const teacherSchedules = [
      { room: "Cisco Lab", start: "08:00", end: "10:00" },
      { room: "Cisco Lab", start: "13:00", end: "15:00" }
    ];

    function isTimeOverlap(start1, end1, start2, end2) {
      return (start1 < end2 && end1 > start2);
    }

    document.getElementById('sitinForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const name = document.getElementById('name').value;
      const year = document.getElementById('year').value;
      const room = document.getElementById('room').value;
      const startTime = document.getElementById('startTime').value;
      const endTime = document.getElementById('endTime').value;
      const purpose = document.getElementById('purpose').value;

      let available = true;

      for (let sched of teacherSchedules) {
        if (sched.room.toLowerCase() === room.toLowerCase()) {
          if (isTimeOverlap(startTime, endTime, sched.start, sched.end)) {
            available = false;
            break;
          }
        }
      }

      if (available) {
        alert("✅ Room is available! Sit-in request approved.");
        // store in localStorage for viewing later
        let sitins = JSON.parse(localStorage.getItem("sitins") || "[]");
        sitins.push({ name, year, room, startTime, endTime, purpose });
        localStorage.setItem("sitins", JSON.stringify(sitins));
      } else {
        alert("❌ Room is NOT available during that time. Please choose another.");
      }

      document.getElementById('sitinForm').reset();
    });
  </script>
</body>
</html>

